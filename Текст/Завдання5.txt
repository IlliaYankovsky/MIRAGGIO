
&НаСервере
Процедура ПеревіритиНаСервере()
	
	Для каждого СтрокаТЧ Из Объект.Періоди Цикл
		
		Если СтрокаТЧ.ДатаПочатку >= СтрокаТЧ.ДатаЗакінчення Тогда
			Сообщить("Існує строка в якій дата закінчення періоду менше або дорівнює даті початку періоду");
			Возврат;
		КонецЕсли;
		СтрокаТЧ.ЄПеретин = Ложь;		
	
	КонецЦикла;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ТаблицяДляОбробки1.ДатаПочатку КАК ДатаПочатку,
	|	ТаблицяДляОбробки1.ДатаЗакінчення КАК ДатаЗакінчення,
	|	ТаблицяДляОбробки1.НомерСтроки КАК НомерСтроки
	|ПОМЕСТИТЬ ТаблицяДляОбробки1
	|ИЗ
	|	&ТаблицяДляОбробки КАК ТаблицяДляОбробки1
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТаблицяДляОбробки2.ДатаПочатку,
	|	ТаблицяДляОбробки2.ДатаЗакінчення,
	|	ТаблицяДляОбробки2.НомерСтроки
	|ПОМЕСТИТЬ ТаблицяДляОбробки2
	|ИЗ
	|	&ТаблицяДляОбробки КАК ТаблицяДляОбробки2
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТаблицяДляОбробки1.НомерСтроки,
	|	ТаблицяДляОбробки2.НомерСтроки КАК НомерСтроки1
	|ИЗ
	|	ТаблицяДляОбробки1 КАК ТаблицяДляОбробки1
	|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицяДляОбробки2 КАК ТаблицяДляОбробки2
	|		ПО (НЕ ТаблицяДляОбробки1.НомерСтроки = ТаблицяДляОбробки2.НомерСтроки)
	|			И (ТаблицяДляОбробки1.ДатаПочатку МЕЖДУ ТаблицяДляОбробки2.ДатаПочатку И ТаблицяДляОбробки2.ДатаЗакінчення
	|				ИЛИ ТаблицяДляОбробки1.ДатаЗакінчення МЕЖДУ ТаблицяДляОбробки2.ДатаПочатку И ТаблицяДляОбробки2.ДатаЗакінчення)
	|ГДЕ
	|	НЕ ТаблицяДляОбробки2.НомерСтроки ЕСТЬ NULL";

	Запрос.УстановитьПараметр("ТаблицяДляОбробки", Объект.Періоди.Выгрузить());
	
	РезультатЗапроса = Запрос.Выполнить().Выгрузить();
	
	Для Каждого СтрокаЗПеретином Из РезультатЗапроса Цикл
		ЗнайденаСтрока = Объект.Періоди.НайтиСтроки(Новый Структура("НомерСтроки",СтрокаЗПеретином.НомерСтроки));
		Если НЕ ЗнайденаСтрока = Неопределено Тогда
			ЗнайденаСтрока[0].ЄПеретин = Истина;		
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры

&НаКлиенте
Процедура Перевірити(Команда)
	ПеревіритиНаСервере();
КонецПроцедуры
